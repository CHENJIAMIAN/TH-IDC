"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[255],{70255:function(e,t,i){i.r(t),i.d(t,{default:function(){return g}});var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.showPage?o("div",{staticClass:"app-container device-group-manage"},[e.hasAuth?e._e():o("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),e.hasAuth?o("div",{staticClass:"head"},[o("el-form",{ref:"filterForm",staticStyle:{display:"grid","grid-auto-flow":"column"},attrs:{inline:!0,size:"medium",model:e.filterForm}},[o("el-form-item",{attrs:{prop:"floorCode"}},[o("el-select",{attrs:{clearable:"",placeholder:"楼层"},on:{change:function(t){return e.$set(e.dialog.forms,"roomCode","")}},model:{value:e.filterForm.floorCode,callback:function(t){e.$set(e.filterForm,"floorCode",t)},expression:"filterForm.floorCode"}},e._l(e.floorOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.floorCode}})})),1)],1),o("el-form-item",{attrs:{prop:"roomCode"}},[o("el-select",{attrs:{clearable:"",placeholder:"房间"},model:{value:e.filterForm.roomCode,callback:function(t){e.$set(e.filterForm,"roomCode",t)},expression:"filterForm.roomCode"}},e._l(e.roomOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.roomCode}})})),1)],1),o("el-form-item",{attrs:{prop:"deviceGroupCode"}},[o("el-input",{attrs:{placeholder:"设备组编号"},model:{value:e.filterForm.deviceGroupCode,callback:function(t){e.$set(e.filterForm,"deviceGroupCode","string"===typeof t?t.trim():t)},expression:"filterForm.deviceGroupCode"}})],1),o("el-form-item",{attrs:{prop:"name"}},[o("el-input",{attrs:{placeholder:"设备组名称"},model:{value:e.filterForm.name,callback:function(t){e.$set(e.filterForm,"name","string"===typeof t?t.trim():t)},expression:"filterForm.name"}})],1),o("el-form-item",{attrs:{prop:"deviceType"}},[o("el-select",{attrs:{clearable:"",placeholder:"设备组类型","popper-class":"three-column"},model:{value:e.filterForm.deviceType,callback:function(t){e.$set(e.filterForm,"deviceType",t)},expression:"filterForm.deviceType"}},e._l(e.deviceTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),o("el-form-item",{attrs:{prop:"groupType"}},[o("el-select",{attrs:{clearable:"",placeholder:"设备组分类"},model:{value:e.filterForm.groupType,callback:function(t){e.$set(e.filterForm,"groupType",t)},expression:"filterForm.groupType"}},e._l(e.groupTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.handleReset("filterForm")}}},[e._v("重置")])],1),o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.handleDialog()}}},[o("i",{staticClass:"el-icon-plus"})])],1)],1)],1):e._e(),e.hasAuth?o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData}},[o("el-table-column",{attrs:{prop:"deviceGroupCode",label:"设备组编号"}}),o("el-table-column",{attrs:{prop:"name",label:"设备组名称"}}),o("el-table-column",{attrs:{prop:"deviceType",label:"设备组类型"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[o("span",[e._v(e._s(e.deviceTypeOpts.find((function(e){return e.id===i.deviceType}))&&e.deviceTypeOpts.find((function(e){return e.id===i.deviceType})).name))])]}}],null,!1,749874441)}),o("el-table-column",{attrs:{prop:"imgUrl",label:"预览图"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleImgDialog(i)}}},[e._v("编辑")])]}}],null,!1,826107909)}),o("el-table-column",{attrs:{prop:"groupType",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[o("span",[e._v(e._s(e.groupTypeOpts.find((function(e){return e.id===i.groupType}))&&e.groupTypeOpts.find((function(e){return e.id===i.groupType})).name))])]}}],null,!1,247876105)}),o("el-table-column",{attrs:{prop:"parentName",label:"父级设备组名称"}}),o("el-table-column",{attrs:{prop:"roomName",label:"房间名称"}}),o("el-table-column",{attrs:{label:"操作",align:"center",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[1==i.groupType?o("el-button",{attrs:{title:"绑定设备",icon:"el-icon-bdsb",type:"primary",plain:""},on:{click:function(t){return e.handleSBDialog(i)}}}):e._e(),2==i.groupType?o("el-button",{attrs:{title:"逻辑设备组绑定实体设备组",icon:"el-icon-guide",type:"primary",plain:""},on:{click:function(t){return e.handleLJDialog(i)}}}):e._e(),o("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(i)}}}),o("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.handleDel(i.id)}}})]}}],null,!1,77931800)})],1):e._e(),e.hasAuth?o("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}}):e._e(),o("el-dialog",{staticClass:"dialog-img",attrs:{visible:e.dialogImg.visible,width:"95%"},on:{"update:visible":function(t){return e.$set(e.dialogImg,"visible",t)}}},[o("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[o("span",{staticClass:"title-txt"},[e._v("图片采点 - "+e._s(e.dialog.forms.name))]),o("img",{attrs:{src:i(1612)}})]),o("div",{staticClass:"content-head"},[o("div"),o("div",[e._v(" 图片类型 "),o("el-select",{model:{value:e.dialogImg.imgType,callback:function(t){e.$set(e.dialogImg,"imgType",t)},expression:"dialogImg.imgType"}},e._l(e.imgTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),o("div",[e._v(" 测点类型 "),o("el-select",{on:{change:function(t){return e.handleImgDialog()}},model:{value:e.dialog.forms.pointType,callback:function(t){e.$set(e.dialog.forms,"pointType",t)},expression:"dialog.forms.pointType"}},e._l(e.pointTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),o("div",[e._v("未绑测点")])]),o("div",{staticClass:"grid"},[o("div",{staticClass:"left"},[e.dialogImg.visible?o("div",{ref:"preiviewImgContainer",staticStyle:{position:"relative"}},[o("img",{ref:"preiviewImg",staticClass:"preview-img",style:{cursor:e.dialogImg.forms.selectedNotBind?"crosshair":"unset"},attrs:{src:e.dialogImg.forms.imgUrl,alt:"加载失败"},on:{click:e.addToBindPointLocation}})]):e._e()]),o("div",{staticClass:"right"},[o("div",{staticClass:"radios"},e._l(e.listDataCDNotBind,(function(t){return o("el-radio",{key:t.id,attrs:{label:t,border:""},model:{value:e.dialogImg.forms.selectedNotBind,callback:function(t){e.$set(e.dialogImg.forms,"selectedNotBind",t)},expression:"dialogImg.forms.selectedNotBind"}},[e._v(e._s(t.name))])})),1),o("div",{staticClass:"table"},[o("el-table",{staticClass:"btm-table",staticStyle:{overflow:"auto"},attrs:{"empty-text":" ",stripe:"",border:"",data:e.listDataCDBind}},[o("el-table-column",{attrs:{sortable:"",prop:"pointCode",label:"测点编号",width:"150"}}),o("el-table-column",{attrs:{sortable:"",prop:"name",label:"测点名称"}}),o("el-table-column",{attrs:{label:"操作",align:"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[o("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.removeToNotBindPointLocation(i)}}})]}}],null,!1,3734692064)})],1)],1)])]),o("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogImgSubmit}},[e._v("保 存")])],1)]),o("el-dialog",{attrs:{visible:e.dialog.visible,top:"10vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[o("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[o("span",{staticClass:"title-txt"},[e._v(e._s(e.dialog.forms.id?"编辑":"新增"))]),o("img",{attrs:{src:i(1612)}})]),o("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"设备组编号",prop:"deviceGroupCode"}},[o("el-input",{attrs:{disabled:!!e.dialog.forms.id},model:{value:e.dialog.forms.deviceGroupCode,callback:function(t){e.$set(e.dialog.forms,"deviceGroupCode",t)},expression:"dialog.forms.deviceGroupCode"}})],1),o("el-form-item",{attrs:{label:"设备组名称",prop:"name"}},[o("el-input",{model:{value:e.dialog.forms.name,callback:function(t){e.$set(e.dialog.forms,"name",t)},expression:"dialog.forms.name"}})],1),o("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr"}},[o("el-form-item",{attrs:{label:"设备组类型",prop:"deviceType"}},[o("el-select",{attrs:{"popper-class":"three-column"},model:{value:e.dialog.forms.deviceType,callback:function(t){e.$set(e.dialog.forms,"deviceType",t)},expression:"dialog.forms.deviceType"}},e._l(e.deviceTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),o("el-form-item",{attrs:{label:"楼层",prop:"floorCode"}},[o("el-select",{on:{change:function(t){return e.$set(e.dialog.forms,"roomCode","")}},model:{value:e.dialog.forms.floorCode,callback:function(t){e.$set(e.dialog.forms,"floorCode",t)},expression:"dialog.forms.floorCode"}},e._l(e.floorOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.floorCode}})})),1)],1)],1),o("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr"}},[o("el-form-item",{attrs:{label:"房间",prop:"roomCode"}},[o("el-select",{model:{value:e.dialog.forms.roomCode,callback:function(t){e.$set(e.dialog.forms,"roomCode",t)},expression:"dialog.forms.roomCode"}},e._l(e.roomOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.roomCode}})})),1)],1),o("el-form-item",{attrs:{label:"设备组分类",prop:"groupType"}},[o("el-select",{model:{value:e.dialog.forms.groupType,callback:function(t){e.$set(e.dialog.forms,"groupType",t)},expression:"dialog.forms.groupType"}},e._l(e.groupTypeOpts,(function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e.dialog.visible?o("el-form-item",{attrs:{label:"预览图",prop:"imgUrl"}},[o("div",{staticClass:"preview-grid"},[o("el-upload",{ref:"upload",staticClass:"upload-container",attrs:{name:"attach",headers:e.headers,action:e.uploadUrl,data:e.uploadData,"on-success":e.uploadSuccess,"on-remove":e.fileRemove,drag:""}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[e._v(" 点击 "),o("em",[e._v("上传文件")]),e._v(" 或拖拽上传 ")])]),e.dialog.forms.imgUrl?o("img",{staticClass:"preview-img",attrs:{src:e.dialog.forms.imgUrl,alt:"图片加载失败"}}):e._e()],1)]):e._e()],1),o("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")])],1)],1),o("el-dialog",{attrs:{visible:e.dialogSB.visible,width:"80%"},on:{"update:visible":function(t){return e.$set(e.dialogSB,"visible",t)}}},[o("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[o("span",{staticClass:"title-txt"},[e._v("绑定设备 - "+e._s(e.dialogSB.forms.name))]),o("img",{attrs:{src:i(1612)}})]),o("el-form",{ref:"dialogSBForm",staticStyle:{display:"grid","justify-content":"center"},attrs:{model:e.dialogSB.forms,rules:e.dialogSB.rules}},[o("el-form-item",{attrs:{label:"",prop:""}},[o("el-transfer",{staticClass:"transfer-cd",attrs:{filterable:"","filter-method":function(e,t){return t.name.indexOf(e)>-1},titles:["未绑定","已绑定"],props:{key:"id",label:"name"},"filter-placeholder":"请输入",data:e.allDeviceOpts},model:{value:e.dialogSB.forms.deviceIdArray,callback:function(t){e.$set(e.dialogSB.forms,"deviceIdArray",t)},expression:"dialogSB.forms.deviceIdArray"}})],1)],1),o("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSBSubmit}},[e._v("保 存")])],1)],1),o("el-dialog",{attrs:{visible:e.dialogLJ.visible,width:"80%"},on:{"update:visible":function(t){return e.$set(e.dialogLJ,"visible",t)}}},[o("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[o("span",{staticClass:"title-txt"},[e._v("逻辑设备组绑定实体设备组 - "+e._s(e.dialogLJ.forms.name))]),o("img",{attrs:{src:i(1612)}})]),o("el-form",{ref:"dialogLJForm",staticStyle:{display:"grid","justify-content":"center"},attrs:{model:e.dialogLJ.forms,rules:e.dialogLJ.rules}},[o("el-form-item",{attrs:{label:"",prop:""}},[o("el-transfer",{staticClass:"transfer-cd",attrs:{filterable:"","filter-method":function(e,t){return t.name.indexOf(e)>-1},titles:["未绑定","已绑定"],props:{key:"id",label:"name"},"filter-placeholder":"请输入",data:e.allDeviceGroupLJOpts},model:{value:e.dialogLJ.forms.deviceGroupIdArray,callback:function(t){e.$set(e.dialogLJ.forms,"deviceGroupIdArray",t)},expression:"dialogLJ.forms.deviceGroupIdArray"}})],1)],1),o("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogLJSubmit}},[e._v("保 存")])],1)],1)],1):e._e()},l=[],a=i(94685),s=i(7169),r=i(47254),n=i(81753),d=i(98803),c={components:{pagination:a.Z},data(){return{showPage:!1,hasAuth:!0,imgTypeOpts:d.eW,uploadedFileUrl:"",headers:{token:(0,n.LP)()},uploadData:{type:3},uploadUrl:r.P,groupTypeOpts:[{id:1,name:"实体设备组"},{id:2,name:"逻辑设备组"}],pointTypeOpts:[],floorOpts:[],roomOpts:[],roomAllOpts:[],deviceTypeOpts:[],pointBindDeviceGroupOpts:[],pointNotBindDeviceGroupOpts:[],allPointOpts:[],deviceBindDeviceGroupOpts:[],deviceNotBindDeviceGroupOpts:[],allDeviceOpts:[],deviceGroupLJBindDeviceGroupOpts:[],deviceGroupLJNotBindDeviceGroupOpts:[],allDeviceGroupLJOpts:[],firstMenuOpts:[],secondMenuOpts:[],filterForm:{floorCode:"",roomCode:"",deviceGroupCode:"",name:"",deviceType:null,pageNo:1,pageSize:10},listLoading:!0,listData:[],listTotal:0,dialog:{id:"",visible:!1,forms:{},rules:{floorCode:[{required:!0,trigger:"blur",message:"请输入"}],roomCode:[{required:!0,trigger:"blur",message:"请输入"}],deviceGroupCode:[{required:!0,trigger:"blur",message:"请输入"}],name:[{required:!0,trigger:"blur",message:"请输入"}],deviceType:[{required:!0,trigger:"blur",message:"请输入"}],groupType:[{required:!0,trigger:"blur",message:"请输入"}]}},dialogImg:{visible:!1,forms:{},rules:{}},dialogSB:{visible:!1,forms:{},rules:{}},dialogLJ:{visible:!1,forms:{},rules:{}},listDataCDBind:[],listDataCDNotBind:[],imgMarkerIdDivMaps:[],currentRow:null}},watch:{async"filterForm.floorCode"(e,t){if(!e)return;this.roomOpts=[];const i=await(0,s.RE)({floorCode:e});this.roomOpts=i.data},async"dialog.forms.floorCode"(e,t){if(!e)return;this.roomOpts=[];const i=await(0,s.RE)({floorCode:e});this.roomOpts=i.data}},created(){(0,s.aJ)().then((e=>this.floorOpts=e.data)),(0,s.RE)().then((e=>this.roomAllOpts=e.data)),(0,s.mA)().then((e=>this.deviceTypeOpts=e.data)),this.handleQuery()},mounted(){},methods:{addToBindPointLocation(e){const{imgType:t,forms:o}=this.dialogImg;if(""===t||void 0===t)return void this.$message.error("请选择绑定测点的图片类型");let l=o.selectedNotBind;if(this.$set(o,"selectedNotBind",""),!l)return;e=e||window.event;const a=e.offsetX||e.layerX,s=e.offsetY||e.layerY,r=document.createElement("img");r.src=i(27297)(`./open${t}.png`),r.title=l.name,r.className="marker";let n="";switch(+t){case 1:case 2:case 3:case 4:n="transform: translate(-50%, -50%);";break;case 5:n="transform: translate(-50%, -50%);";break}r.style=n,r.onclick=()=>{this.$refs["preiviewImgContainer"].removeChild(r);const e=this.imgMarkerIdDivMaps.findIndex((e=>e.div==r));e>-1&&this.imgMarkerIdDivMaps.splice(e,1);const t=this.listDataCDBind.find((e=>e.id==l.id));this.removeToNotBindPointLocation(t)},r.style.left=a+"px",r.style.top=s+"px",this.$refs["preiviewImgContainer"].appendChild(r),this.imgMarkerIdDivMaps.push({id:l.id,div:r});const d=this.$refs["preiviewImg"],c=d.clientWidth,m=d.clientHeight,p=a/c,u=s/m;l.location=u+","+p,l.imgType=this.dialogImg.imgType,this.listDataCDBind.push(l);const g=this.listDataCDNotBind.indexOf(l);g>-1&&this.listDataCDNotBind.splice(g,1)},removeToNotBindPointLocation(e){const t=this.listDataCDBind.indexOf(e);t>-1&&this.listDataCDBind.splice(t,1),this.listDataCDNotBind=this.listDataCDNotBind.concat(e);const i=this.imgMarkerIdDivMaps.find((t=>t.id==e.id));if(!i)return;this.$refs["preiviewImgContainer"].removeChild(i.div);const o=this.imgMarkerIdDivMaps.indexOf(i);o>-1&&this.imgMarkerIdDivMaps.splice(o,1)},async handleImgDialog(e){if(this.listLoading=!0,!e){e=this.currentRow;const t=await(0,s.fe)({deviceGroupId:e.id,pointType:this.dialog.forms.pointType||null});return void(this.listDataCDNotBind=t.data)}this.currentRow=e,this.dialog.forms.name=e.name,this.pointTypeOpts=[];const t=await(0,s.W3)({deviceTypeId:e.deviceType});this.pointTypeOpts=t.data;const o=await(0,s.j7)({deviceGroupId:e.id});this.listDataCDBind=o.data;const l=await(0,s.fe)({deviceGroupId:e.id,pointType:this.dialog.forms.pointType||null});this.listDataCDNotBind=l.data,this.imgMarkerIdDivMaps=[],this.dialogImg.visible=!0,this.listLoading=!1,this.dialogImg.forms.deviceGroupId=e.id,this.dialogImg.forms.imgUrl=e.imgUrl,this.$nextTick((e=>{const t=this.$refs["preiviewImg"],o=()=>{this.listDataCDBind.forEach((e=>{const o=e.location.split(",");if(!o||o.length<2)return;const l=t.clientWidth,a=t.clientHeight,s=o[0],r=o[1],n=document.createElement("img");n.src=i(27297)(`./open${e.imgType}.png`),n.title=e.name,n.className="marker";let d="";switch(+e.imgType){case 1:case 2:case 3:case 4:d="transform: translate(-50%, -50%);";break;case 5:d="transform: translate(-50%, -50%);";break}n.style=d,n.onclick=()=>{this.$refs["preiviewImgContainer"].removeChild(n);const t=this.imgMarkerIdDivMaps.findIndex((e=>e.div==n));t>-1&&this.imgMarkerIdDivMaps.splice(t,1);const i=this.listDataCDBind.find((t=>t.id==e.id));this.removeToNotBindPointLocation(i)},console.log("location",o,s,r),console.log("currWidth,currHeight",l,a);let c=l*r,m=a*s;n.style.left=c+"px",n.style.top=m+"px",this.$refs["preiviewImgContainer"].appendChild(n),this.imgMarkerIdDivMaps.push({id:e.id,div:n})}))};t.onload=()=>{o()},t.complete&&o()}))},async handleSBDialog(e){if(e){this.dialogSB.forms={id:e.id,name:e.name};const t=await(0,s.GM)({id:e.id});this.deviceNotBindDeviceGroupOpts=t.data;const i=await(0,s.MW)({id:e.id});this.deviceBindDeviceGroupOpts=i.data,this.$set(this.dialogSB.forms,"deviceIdArray",i.data.map((e=>e.id))),this.allDeviceOpts=this.deviceNotBindDeviceGroupOpts.concat(this.deviceBindDeviceGroupOpts)}this.dialogSB.visible=!0,this.$nextTick((e=>this.$refs["dialogSBForm"].clearValidate()))},async handleLJDialog(e){if(e){this.dialogLJ.forms={id:e.id,name:e.name};const t=await(0,s.lA)({id:e.id});this.deviceGroupLJNotBindDeviceGroupOpts=t.data;const i=await(0,s.Pt)({id:e.id});this.deviceGroupLJBindDeviceGroupOpts=i.data,this.$set(this.dialogLJ.forms,"deviceGroupIdArray",i.data.map((e=>e.id))),this.allDeviceGroupLJOpts=this.deviceGroupLJNotBindDeviceGroupOpts.concat(this.deviceGroupLJBindDeviceGroupOpts)}this.dialogLJ.visible=!0,this.$nextTick((e=>this.$refs["dialogLJForm"].clearValidate()))},uploadSuccess(e,t,i){0===e.res?(this.dialog.forms.imgUrl=e.data.filePath,this.$message.success("上传成功!")):this.$message.error(e.msg),this.$refs["dialogForm"].validateField("imgUrl")},fileRemove(e,t){this.dialog.forms.imgUrl="",this.$refs["dialogForm"].validateField("imgUrl")},dialogImgSubmit(){this.dialogImg.forms.pointList=this.listDataCDBind,this.dialogImg.forms.pointList=this.dialogImg.forms.pointList.map((e=>(e.pointId=e.id,delete e.id,e)));const{deviceGroupId:e,pointList:t}=this.dialogImg.forms;(0,s.zS)({deviceGroupId:e,pointList:t}).then((e=>{this.$message.success("操作成功!"),this.dialogImg.visible=!1,this.getList()}))},dialogSBSubmit(){this.$refs["dialogSBForm"].validate(((e,t)=>{if(!e)return!1;(0,s.O7)(this.dialogSB.forms).then((e=>{this.$message.success("操作成功!"),this.$refs["dialogSBForm"].resetFields(),this.dialogSB.visible=!1,this.getList()}))}))},dialogSubmit(){this.$refs["dialogForm"].validate(((e,t)=>{if(!e)return!1;{let e=null;e=this.dialog.forms.id?s.uv:s.C8,e(this.dialog.forms).then((e=>{this.$message.success("操作成功!"),this.$refs["dialogForm"].resetFields(),this.dialog.visible=!1,this.getList()}))}}))},handleQuery(){this.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},async handleDialog(e){this.dialog.forms=e?Object.assign(JSON.parse(JSON.stringify(e))):{imgUrl:"",roomCode:""},this.dialog.visible=!0,this.$nextTick((e=>this.$refs["dialogForm"].clearValidate()))},dialogLJSubmit(){this.$refs["dialogLJForm"].validate(((e,t)=>{if(!e)return!1;(0,s.li)(this.dialogLJ.forms).then((e=>{this.$message.success("操作成功!"),this.$refs["dialogLJForm"].resetFields(),this.dialogLJ.visible=!1,this.getList()}))}))},handleDel(e){this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,s.e9)({id:e}).then((e=>{this.getList(),this.$message.success("删除成功!")}))})).catch((()=>{}))},getList(){this.listLoading=!0,(0,s.bg)(this.filterForm).then((e=>{this.hasAuth=!0,this.listData=e.data.list,this.listTotal=e.data.total,this.listLoading=!1})).catch((e=>{this.hasAuth=!1})).finally((e=>{this.showPage=!0}))}}},m=c,p=i(1001),u=(0,p.Z)(m,o,l,!1,null,"fc264dd6",null),g=u.exports},47254:function(e,t,i){i.d(t,{P:function(){return l}});i(25972);const o="",l=o+"/admin/uploadFile/upload"},98803:function(e,t,i){i.d(t,{C0:function(){return s},Mj:function(){return o},Uz:function(){return r},eW:function(){return a},ed:function(){return l}});i(21703);const o=[{id:1,name:"整型"},{id:2,name:"长整型"},{id:3,name:"浮点型"},{id:4,name:"布尔型"},{id:5,name:"字符串"},{id:6,name:"时间戳"}],l=[{id:1,name:"邮箱"},{id:2,name:"短信"},{id:3,name:"语音"},{id:4,name:"微信"},{id:5,name:"钉钉"},{id:6,name:"声光"}],a=[{id:1,name:"北向开关"},{id:2,name:"东向开关"},{id:3,name:"西向开关"},{id:4,name:"南向开关"},{id:5,name:"温度计"}],s=(e,t,i)=>{e.required||void 0!==t&&""!==t||i(),""===t||!Number.isInteger(+t)||+t<0?i(new Error("请输入整数值")):i()},r=(e,t,i)=>{""===t||isNaN(t)||Number(t)<0?i(new Error("请输入非负数字")):i()}}}]);