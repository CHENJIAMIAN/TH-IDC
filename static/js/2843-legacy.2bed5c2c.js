"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[2843],{12843:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.showPage?r("div",{staticClass:"app-container measure-point-manage"},[e.hasAuth?e._e():r("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),e.hasAuth?r("div",{staticClass:"head"},[r("el-form",{ref:"filterForm",staticStyle:{display:"grid","grid-auto-flow":"column"},attrs:{inline:!0,size:"medium",model:e.filterForm}},[r("el-form-item",{attrs:{prop:"floorCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"楼层"},on:{change:function(t){e.$set(e.filterForm,"roomCode",""),e.$set(e.filterForm,"deviceGroupCode",""),e.$set(e.filterForm,"deviceCode","")}},model:{value:e.filterForm.floorCode,callback:function(t){e.$set(e.filterForm,"floorCode",t)},expression:"filterForm.floorCode"}},e._l(e.floorOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.floorCode}})})),1)],1),r("el-form-item",{attrs:{prop:"roomCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"房间"},on:{change:function(t){e.$set(e.filterForm,"deviceGroupCode",""),e.$set(e.filterForm,"deviceCode","")}},model:{value:e.filterForm.roomCode,callback:function(t){e.$set(e.filterForm,"roomCode",t)},expression:"filterForm.roomCode"}},e._l(e.roomOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.roomCode}})})),1)],1),r("el-form-item",{attrs:{prop:"deviceGroupCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"设备组"},on:{change:function(t){return e.$set(e.filterForm,"deviceCode","")}},model:{value:e.filterForm.deviceGroupCode,callback:function(t){e.$set(e.filterForm,"deviceGroupCode",t)},expression:"filterForm.deviceGroupCode"}},e._l(e.deviceGroupOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.deviceGroupCode}})})),1)],1),r("el-form-item",{attrs:{prop:"deviceCode"}},[r("el-select",{attrs:{clearable:"",placeholder:"设备"},model:{value:e.filterForm.deviceCode,callback:function(t){e.$set(e.filterForm,"deviceCode",t)},expression:"filterForm.deviceCode"}},e._l(e.deviceOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.deviceCode}})})),1)],1),r("el-form-item",{attrs:{prop:"name"}},[r("el-input",{attrs:{placeholder:"测点名称"},model:{value:e.filterForm.name,callback:function(t){e.$set(e.filterForm,"name","string"===typeof t?t.trim():t)},expression:"filterForm.name"}})],1),r("el-form-item",{attrs:{prop:"pointCode"}},[r("el-input",{attrs:{placeholder:"测点编号"},model:{value:e.filterForm.pointCode,callback:function(t){e.$set(e.filterForm,"pointCode","string"===typeof t?t.trim():t)},expression:"filterForm.pointCode"}})],1),r("el-form-item",{attrs:{prop:"pointType"}},[r("el-select",{attrs:{clearable:"",placeholder:"测点类型","popper-class":"three-column"},model:{value:e.filterForm.pointType,callback:function(t){e.$set(e.filterForm,"pointType",t)},expression:"filterForm.pointType"}},e._l(e.pointAllTypeOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.handleReset("filterForm")}}},[e._v("重置")])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.handleDialog()}}},[r("i",{staticClass:"el-icon-plus"})])],1)],1)],1):e._e(),e.hasAuth?r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData}},[r("el-table-column",{attrs:{prop:"pointCode",label:"测点编号"}}),r("el-table-column",{attrs:{prop:"name",label:"测点名称"}}),r("el-table-column",{attrs:{prop:"pointType",label:"测点类型"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[r("span",[e._v(e._s(e.pointAllTypeOpts.find((function(e){return e.id===o.pointType}))&&e.pointAllTypeOpts.find((function(e){return e.id===o.pointType})).name))])]}}],null,!1,4064201609)}),r("el-table-column",{attrs:{prop:"deviceName",label:"设备名称"}}),r("el-table-column",{attrs:{prop:"deviceGroupName",label:"设备组名称"}}),r("el-table-column",{attrs:{prop:"roomName",label:"房间名称"}}),r("el-table-column",{attrs:{prop:"floorName",label:"楼层名称"}}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"161"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[r("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(o)}}}),r("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.handleDel(o.id)}}})]}}],null,!1,1998501215)})],1):e._e(),e.hasAuth?r("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}}):e._e(),r("el-dialog",{attrs:{visible:e.dialog.visible},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[r("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[r("span",{staticClass:"title-txt"},[e._v(e._s(e.dialog.forms.id?"编辑":"新增"))]),r("img",{attrs:{src:o(1612)}})]),r("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"测点编号",prop:"pointCode"}},[r("el-input",{attrs:{disabled:!!e.dialog.forms.id},model:{value:e.dialog.forms.pointCode,callback:function(t){e.$set(e.dialog.forms,"pointCode",t)},expression:"dialog.forms.pointCode"}})],1),r("el-form-item",{attrs:{label:"测点名称",prop:"name"}},[r("el-input",{model:{value:e.dialog.forms.name,callback:function(t){e.$set(e.dialog.forms,"name",t)},expression:"dialog.forms.name"}})],1),r("div",{staticStyle:{display:"grid","grid-template-columns":"310fr 280fr 300fr"}},[r("el-form-item",{attrs:{label:"楼层",prop:"floorCode"}},[r("el-select",{on:{change:function(){e.$set(e.dialog.forms,"roomCode",""),e.$set(e.dialog.forms,"deviceGroupCode","")}},model:{value:e.dialog.forms.floorCode,callback:function(t){e.$set(e.dialog.forms,"floorCode",t)},expression:"dialog.forms.floorCode"}},e._l(e.floorOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.floorCode}})})),1)],1),r("el-form-item",{attrs:{label:"房间",prop:"roomCode"}},[r("el-select",{on:{change:function(t){return e.$set(e.dialog.forms,"deviceGroupCode","")}},model:{value:e.dialog.forms.roomCode,callback:function(t){e.$set(e.dialog.forms,"roomCode",t)},expression:"dialog.forms.roomCode"}},e._l(e.roomOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.roomCode}})})),1)],1),r("el-form-item",{attrs:{label:"设备",prop:"deviceCode"}},[r("el-select",{model:{value:e.dialog.forms.deviceCode,callback:function(t){e.$set(e.dialog.forms,"deviceCode",t)},expression:"dialog.forms.deviceCode"}},e._l(e.deviceOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.deviceCode}})})),1)],1)],1),r("div",{staticStyle:{display:"grid","grid-template-columns":"310fr 280fr 300fr"}},[r("el-form-item",{attrs:{label:"设备类型",prop:"deviceTypeId"}},[r("el-select",{attrs:{"popper-class":"three-column"},on:{change:function(t){return e.$set(e.dialog.forms,"pointType","")}},model:{value:e.dialog.forms.deviceTypeId,callback:function(t){e.$set(e.dialog.forms,"deviceTypeId",t)},expression:"dialog.forms.deviceTypeId"}},e._l(e.deviceTypeOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"测点类型",prop:"pointType"}},[r("el-select",{model:{value:e.dialog.forms.pointType,callback:function(t){e.$set(e.dialog.forms,"pointType",t)},expression:"dialog.forms.pointType"}},e._l(e.pointTypeOpts,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")])],1)],1)],1):e._e()},i=[],n=o(16198),l=o(23796),a=(o(38862),o(41539),o(35666),o(94685)),s=o(7169),d={components:{pagination:a.Z},data:function(){var e;return e={showPage:!1,hasAuth:!0,floorOpts:[],roomOpts:[],deviceGroupOpts:[],deviceOpts:[],pointTypeOpts:[],pointAllTypeOpts:[]},(0,l.Z)(e,"pointAllTypeOpts",[]),(0,l.Z)(e,"deviceTypeOpts",[]),(0,l.Z)(e,"firstMenuOpts",[]),(0,l.Z)(e,"secondMenuOpts",[]),(0,l.Z)(e,"filterForm",{floorCode:"",roomCode:"",deviceGroupCode:"",deviceCode:"",name:"",pointCode:"",pointType:null,pageNo:1,pageSize:10}),(0,l.Z)(e,"listLoading",!0),(0,l.Z)(e,"listData",[]),(0,l.Z)(e,"listTotal",0),(0,l.Z)(e,"dialog",{id:"",visible:!1,forms:{},rules:{floorCode:[{required:!0,trigger:"blur",message:"请输入"}],roomCode:[{required:!0,trigger:"blur",message:"请输入"}],deviceGroupCode:[{required:!0,trigger:"blur",message:"请输入"}],deviceTypeId:[{required:!0,trigger:"blur",message:"请输入"}],pointCode:[{required:!0,trigger:"blur",message:"请输入"}],name:[{required:!0,trigger:"blur",message:"请输入"}],deviceCode:[{required:!0,trigger:"blur",message:"请输入"}],pointType:[{required:!0,trigger:"blur",message:"请输入"}],actionType:[{required:!0,trigger:"change",message:"请输入"}]}}),e},watch:{"dialog.forms.deviceTypeId":function(e,t){var o=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return o.pointTypeOpts=[],t.next=5,(0,s.W3)({deviceTypeId:e});case 5:r=t.sent,o.pointTypeOpts=r.data;case 7:case"end":return t.stop()}}),t)})))()},"filterForm.floorCode":function(e,t){var o=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return o.roomOpts=[],o.deviceGroupOpts=[],o.deviceOpts=[],t.next=7,(0,s.RE)({floorCode:e});case 7:r=t.sent,o.roomOpts=r.data;case 9:case"end":return t.stop()}}),t)})))()},"filterForm.roomCode":function(e,t){var o=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return o.deviceGroupOpts=[],o.deviceOpts=[],t.next=6,(0,s.as)({roomCode:e});case 6:return r=t.sent,t.next=9,(0,s.w8)({roomCode:e});case 9:i=t.sent,o.deviceOpts=r.data,o.deviceGroupOpts=i.data;case 12:case"end":return t.stop()}}),t)})))()},"filterForm.deviceGroupCode":function(e,t){return(0,n.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:case"end":return t.stop()}}),t)})))()},"dialog.forms.floorCode":function(e,t){var o=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return o.roomOpts=[],o.deviceGroupOpts=[],t.next=6,(0,s.RE)({floorCode:e});case 6:r=t.sent,o.roomOpts=r.data;case 8:case"end":return t.stop()}}),t)})))()},"dialog.forms.roomCode":function(e,t){var o=this;return(0,n.Z)(regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return o.deviceOpts=[],o.deviceGroupOpts=[],t.next=6,(0,s.as)({roomCode:e});case 6:return r=t.sent,t.next=9,(0,s.w8)({roomCode:e});case 9:i=t.sent,o.deviceOpts=r.data,o.deviceGroupOpts=i.data;case 12:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;(0,s.aJ)().then((function(t){return e.floorOpts=t.data})),(0,s.mA)().then((function(t){return e.deviceTypeOpts=t.data})),(0,s.W3)().then((function(t){return e.pointAllTypeOpts=t.data})),this.handleQuery()},mounted:function(){},methods:{dialogSubmit:function(){var e=this;this.$refs["dialogForm"].validate((function(t,o){if(!t)return!1;switch(e.dialog.forms.actionType){case 1:delete e.dialog.forms.deviceCode;break;case 2:delete e.dialog.forms.deviceGroupCode;break}var r=null;r=e.dialog.forms.id?s.nu:s.ZO,r(e.dialog.forms).then((function(t){e.$message.success("操作成功!"),e.$refs["dialogForm"].resetFields(),e.dialog.visible=!1,e.getList()}))}))},handleQuery:function(){this.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset:function(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},handleDialog:function(e){var t=this;return(0,n.Z)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:e?(e.deviceTypeId=e.deviceType,t.dialog.forms=Object.assign(JSON.parse(JSON.stringify(e)))):t.dialog.forms={roomCode:"",deviceGroupCode:""},t.dialog.visible=!0,t.$nextTick((function(e){return t.$refs["dialogForm"].clearValidate()}));case 3:case"end":return o.stop()}}),o)})))()},handleDel:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,s.ni)({id:e}).then((function(e){t.getList(),t.$message.success("删除成功!")}))})).catch((function(){}))},getList:function(){var e=this;this.listLoading=!0,(0,s.JN)(this.filterForm).then((function(t){e.hasAuth=!0,e.listData=t.data.list,e.listTotal=t.data.total,e.listLoading=!1})).catch((function(t){e.hasAuth=!1})).finally((function(t){e.showPage=!0}))}}},c=d,u=o(1001),p=(0,u.Z)(c,r,i,!1,null,"703804fe",null),m=p.exports}}]);