"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[5641],{61194:function(e,t,r){var n=r(32538),i=r(35565).find,a=r(35707),l="find",s=!0;l in[]&&Array(1)[l]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a(l)},75641:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showPage?n("div",{staticClass:"app-container auth-manage"},[e.hasAuth?e._e():n("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),e.hasAuth?n("div",{staticClass:"head"},[n("el-form",{ref:"filterForm",staticStyle:{display:"grid","grid-auto-flow":"column"},attrs:{inline:!0,size:"medium",model:e.filterForm}},[n("el-form-item",{attrs:{prop:"level1Id"}},[n("el-select",{attrs:{clearable:"",placeholder:"子系统名称"},on:{change:function(){e.$set(e.filterForm,"level2Id",null),e.$set(e.filterForm,"menuId",null)}},model:{value:e.filterForm.level1Id,callback:function(t){e.$set(e.filterForm,"level1Id",t)},expression:"filterForm.level1Id"}},e._l(e.firstMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{prop:"level2Id"}},[n("el-select",{attrs:{clearable:"",placeholder:"模块名称"},on:{change:function(t){return e.$set(e.filterForm,"menuId",null)}},model:{value:e.filterForm.level2Id,callback:function(t){e.$set(e.filterForm,"level2Id",t)},expression:"filterForm.level2Id"}},e._l(e.secondMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{prop:"menuId"}},[n("el-select",{attrs:{clearable:"",placeholder:"菜单名称"},model:{value:e.filterForm.menuId,callback:function(t){e.$set(e.filterForm,"menuId",t)},expression:"filterForm.menuId"}},e._l(e.thirdMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{prop:"name"}},[n("el-input",{attrs:{placeholder:"权限名称"},model:{value:e.filterForm.name,callback:function(t){e.$set(e.filterForm,"name","string"===typeof t?t.trim():t)},expression:"filterForm.name"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.handleReset("filterForm")}}},[e._v("重置")])],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.handleDialog()}}},[n("i",{staticClass:"el-icon-plus"})])],1)],1)],1):e._e(),e.hasAuth?n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData}},[n("el-table-column",{attrs:{sortable:"",prop:"name",label:"权限名称"}}),n("el-table-column",{attrs:{prop:"permission",label:"标签"}}),n("el-table-column",{attrs:{prop:"level1Name",label:"所属模块名称"}}),n("el-table-column",{attrs:{prop:"level2Name",label:"所属子系统名称"}}),n("el-table-column",{attrs:{prop:"level3Name",label:"所属菜单名称"}}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"161"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(r)}}}),n("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.handleDel(r.id)}}})]}}],null,!1,1998501215)})],1):e._e(),e.hasAuth?n("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}}):e._e(),n("el-dialog",{attrs:{visible:e.dialog.visible,top:"20vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[n("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[n("span",{staticClass:"title-txt"},[e._v(e._s(e.dialog.forms.id?"编辑":"新增"))]),n("img",{attrs:{src:r(1612)}})]),n("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"权限名称",prop:"name"}},[n("el-input",{model:{value:e.dialog.forms.name,callback:function(t){e.$set(e.dialog.forms,"name",t)},expression:"dialog.forms.name"}})],1),n("el-form-item",{attrs:{label:"权限标签",prop:"permission"}},[n("el-input",{model:{value:e.dialog.forms.permission,callback:function(t){e.$set(e.dialog.forms,"permission",t)},expression:"dialog.forms.permission"}})],1),n("el-form-item",{attrs:{label:"子系统",prop:"firstMenuId"}},[n("el-select",{on:{change:function(){e.$set(e.dialog.forms,"secondMenuId",""),e.$set(e.dialog.forms,"thirdMenuId","")}},model:{value:e.dialog.forms.firstMenuId,callback:function(t){e.$set(e.dialog.forms,"firstMenuId",t)},expression:"dialog.forms.firstMenuId"}},e._l(e.firstMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"模块",prop:"secondMenuId"}},[n("el-select",{on:{change:function(t){return e.$set(e.dialog.forms,"thirdMenuId","")}},model:{value:e.dialog.forms.secondMenuId,callback:function(t){e.$set(e.dialog.forms,"secondMenuId",t)},expression:"dialog.forms.secondMenuId"}},e._l(e.secondMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),n("el-form-item",{attrs:{label:"菜单",prop:"thirdMenuId"}},[n("el-select",{model:{value:e.dialog.forms.thirdMenuId,callback:function(t){e.$set(e.dialog.forms,"thirdMenuId",t)},expression:"dialog.forms.thirdMenuId"}},e._l(e.thirdMenuOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),n("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")])],1)],1)],1):e._e()},i=[],a=r(12516),l=(r(17822),r(61194),r(23087),r(10405),r(87130)),s=r(42070),o={components:{pagination:l.Z},data:function(){return{showPage:!1,hasAuth:!0,depOpts:[],firstMenuOpts:[],secondMenuOpts:[],thirdMenuOpts:[],filterForm:{name:"",menuId:null,level2Id:null,level1Id:null,pageNo:1,pageSize:10},listLoading:!0,listData:[],listTotal:0,dialog:{id:"",visible:!1,forms:{},rules:{name:[{required:!0,trigger:"blur",message:"请输入"}],permission:[{required:!0,trigger:"blur",message:"请输入"}],menuType:[{required:!0,trigger:"change",message:"请输入"}],firstMenuId:[{required:!0,trigger:"blur",message:"请输入"}],secondMenuId:[{required:!0,trigger:"blur",message:"请输入"}],thirdMenuId:[{required:!0,trigger:"blur",message:"请输入"}]}}}},watch:{"filterForm.level1Id":function(e,t){var r=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return r.secondMenuOpts=[],r.thirdMenuOpts=[],t.next=6,(0,s.Ee)({parentId:e,menuType:2});case 6:n=t.sent,r.secondMenuOpts=n.data;case 8:case"end":return t.stop()}}),t)})))()},"filterForm.level2Id":function(e,t){var r=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return r.thirdMenuOpts=[],t.next=5,(0,s.Ee)({parentId:e,menuType:3});case 5:n=t.sent,r.thirdMenuOpts=n.data;case 7:case"end":return t.stop()}}),t)})))()},"dialog.forms.firstMenuId":function(e,t){var r=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return r.secondMenuOpts=[],r.thirdMenuOpts=[],t.next=6,(0,s.Ee)({parentId:e,menuType:2});case 6:n=t.sent,r.secondMenuOpts=n.data;case 8:case"end":return t.stop()}}),t)})))()},"dialog.forms.secondMenuId":function(e,t){var r=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return r.thirdMenuOpts=[],t.next=5,(0,s.Ee)({parentId:e,menuType:3});case 5:n=t.sent,r.thirdMenuOpts=n.data;case 7:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,s.Ee)({menuType:1});case 2:r=t.sent,e.firstMenuOpts=r.data,e.handleQuery();case 5:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{dialogSubmit:function(){var e=this;this.$refs["dialogForm"].validate((function(t,r){if(!t)return!1;var n=null;e.dialog.forms.thirdMenuId?(e.dialog.forms.menuId=e.dialog.forms.thirdMenuId,n=e.dialog.forms.id?s.o_:s.eV,n(e.dialog.forms).then((function(t){e.$message.success("操作成功!"),e.$refs["dialogForm"].resetFields(),e.dialog.visible=!1,e.getList()}))):e.$message.error("请选择父级菜单")}))},handleQuery:function(){this.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset:function(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},handleDialog:function(e){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function r(){var n,i,a,l,o,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,s.Ee)({menuType:1});case 2:if(n=r.sent,t.firstMenuOpts=n.data,!e){r.next=23;break}return t.dialog.forms=Object.assign(JSON.parse(JSON.stringify(e))),console.log(t.dialog.forms),r.next=9,(0,s.Ee)({menuType:3});case 9:return i=r.sent,r.next=12,(0,s.Ee)({menuType:2});case 12:a=r.sent,t.thirdMenuOpts=i.data,t.secondMenuOpts=a.data,l=t.thirdMenuOpts.find((function(t){return t.id===e.menuId})),o=t.secondMenuOpts.find((function(e){return e.id===l.parentId})),u=t.firstMenuOpts.find((function(e){return e.id===o.parentId})),t.$set(t.dialog.forms,"thirdMenuId",e.menuId),t.$set(t.dialog.forms,"secondMenuId",o.id),t.$set(t.dialog.forms,"firstMenuId",u.id),r.next=24;break;case 23:t.dialog.forms={};case 24:t.dialog.visible=!0,t.$nextTick((function(e){return t.$refs["dialogForm"].clearValidate()}));case 26:case"end":return r.stop()}}),r)})))()},handleDel:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,s.OE)({id:e}).then((function(e){t.getList(),t.$message.success("删除成功!")}))})).catch((function(){}))},getList:function(){var e=this;this.listLoading=!0,(0,s.uT)(this.filterForm).then((function(t){e.hasAuth=!0,e.listData=t.data.list,e.listTotal=t.data.total,e.listLoading=!1})).catch((function(t){e.hasAuth=!1})).finally((function(t){e.showPage=!0}))}}},u=o,d=r(35471),c=(0,d.Z)(u,n,i,!1,null,"5d1fbeae",null),m=c.exports}}]);