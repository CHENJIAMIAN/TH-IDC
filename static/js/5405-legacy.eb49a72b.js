"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[5405],{5405:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var l=function(){var e=this,t=e.$createElement,l=e._self._c||t;return e.showPage?l("div",{staticClass:"app-container user-manage"},[e.hasAuth?e._e():l("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),e.hasAuth?l("div",{staticClass:"head"},[l("el-form",{ref:"filterForm",staticStyle:{display:"grid","grid-auto-flow":"column"},attrs:{inline:!0,size:"medium",model:e.filterForm}},[l("el-form-item",{attrs:{prop:"userName"}},[l("el-input",{attrs:{placeholder:"账号"},model:{value:e.filterForm.userName,callback:function(t){e.$set(e.filterForm,"userName","string"===typeof t?t.trim():t)},expression:"filterForm.userName"}})],1),l("el-form-item",{attrs:{prop:"realName"}},[l("el-input",{attrs:{placeholder:"姓名"},model:{value:e.filterForm.realName,callback:function(t){e.$set(e.filterForm,"realName","string"===typeof t?t.trim():t)},expression:"filterForm.realName"}})],1),l("el-form-item",{attrs:{prop:"phone"}},[l("el-input",{attrs:{placeholder:"电话"},model:{value:e.filterForm.phone,callback:function(t){e.$set(e.filterForm,"phone","string"===typeof t?t.trim():t)},expression:"filterForm.phone"}})],1),l("el-form-item",{attrs:{prop:"departmentId"}},[l("el-select",{attrs:{clearable:"",placeholder:"部门"},model:{value:e.filterForm.departmentId,callback:function(t){e.$set(e.filterForm,"departmentId",t)},expression:"filterForm.departmentId"}},e._l(e.depOpts,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{attrs:{prop:"status"}},[l("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:e.filterForm.status,callback:function(t){e.$set(e.filterForm,"status",t)},expression:"filterForm.status"}},[l("el-option",{attrs:{"text-color":"#55fb55",label:"启用",value:1}}),l("el-option",{attrs:{"text-color":"gray",label:"禁用",value:0}})],1)],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}})],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.handleReset("filterForm")}}},[e._v("重置")])],1),l("el-form-item",[l("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.handleDialog()}}},[l("i",{staticClass:"el-icon-plus"})])],1)],1)],1):e._e(),e.hasAuth?l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData,size:"medium"}},[l("el-table-column",{attrs:{sortable:"",prop:"userName",label:"账号"}}),l("el-table-column",{attrs:{sortable:"",prop:"realName",label:"姓名"}}),l("el-table-column",{attrs:{prop:"roleNameList",label:"角色"}}),l("el-table-column",{attrs:{prop:"departmentName",label:"部门"}}),l("el-table-column",{attrs:{prop:"phone",label:"电话"}}),l("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),l("el-table-column",{attrs:{prop:"wechat",label:"微信"}}),l("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.status?l("span",{staticStyle:{color:"#55fb55"}},[e._v("启用")]):l("span",{staticStyle:{color:"gray"}},[e._v("禁用")])]}}],null,!1,2360779935)}),l("el-table-column",{attrs:{label:"操作",align:"center",width:"161"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[l("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(a)}}}),l("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.handleDel(a.id)}}})]}}],null,!1,1998501215)})],1):e._e(),e.hasAuth?l("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}}):e._e(),l("el-dialog",{attrs:{visible:e.dialog.visible,top:"5vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[l("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[l("span",{staticClass:"title-txt"},[e._v(e._s(e.dialog.forms.id?"编辑":"新增"))]),l("img",{attrs:{src:a(1612)}})]),l("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"60px"}},[l("el-form-item",{attrs:{label:"账号",prop:"userName"}},[l("el-input",{attrs:{disabled:!!e.dialog.forms.id},model:{value:e.dialog.forms.userName,callback:function(t){e.$set(e.dialog.forms,"userName",t)},expression:"dialog.forms.userName"}})],1),e.dialog.forms.id?e._e():l("el-form-item",{attrs:{label:"密码",prop:"password"}},[l("el-input",{model:{value:e.dialog.forms.password,callback:function(t){e.$set(e.dialog.forms,"password",t)},expression:"dialog.forms.password"}})],1),l("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr 1fr"}},[l("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[l("el-input",{model:{value:e.dialog.forms.realName,callback:function(t){e.$set(e.dialog.forms,"realName",t)},expression:"dialog.forms.realName"}})],1),l("el-form-item",{attrs:{label:"电话",prop:"phone"}},[l("el-input",{model:{value:e.dialog.forms.phone,callback:function(t){e.$set(e.dialog.forms,"phone",t)},expression:"dialog.forms.phone"}})],1)],1),l("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr 1fr"}},[l("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[l("el-input",{model:{value:e.dialog.forms.email,callback:function(t){e.$set(e.dialog.forms,"email",t)},expression:"dialog.forms.email"}})],1),l("el-form-item",{attrs:{label:"微信",prop:"wechat"}},[l("el-input",{model:{value:e.dialog.forms.wechat,callback:function(t){e.$set(e.dialog.forms,"wechat",t)},expression:"dialog.forms.wechat"}})],1),l("el-form-item",{attrs:{label:"钉钉",prop:"dingtalk"}},[l("el-input",{model:{value:e.dialog.forms.dingtalk,callback:function(t){e.$set(e.dialog.forms,"dingtalk",t)},expression:"dialog.forms.dingtalk"}})],1)],1),l("el-form-item",{attrs:{label:"描述",prop:"remarks"}},[l("el-input",{attrs:{type:"textarea"},model:{value:e.dialog.forms.remarks,callback:function(t){e.$set(e.dialog.forms,"remarks",t)},expression:"dialog.forms.remarks"}})],1),l("el-form-item",{staticClass:"rooms-form-item",attrs:{label:"角色",prop:"roleIdArray"}},[l("el-checkbox-group",{staticClass:"rooms-el-checkbox-group",model:{value:e.dialog.forms.roleIdArray,callback:function(t){e.$set(e.dialog.forms,"roleIdArray",t)},expression:"dialog.forms.roleIdArray"}},e._l(e.roleOpts,(function(t){return l("el-checkbox",{key:t.id,attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])})),1)],1),l("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr"}},[l("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[l("el-select",{model:{value:e.dialog.forms.departmentId,callback:function(t){e.$set(e.dialog.forms,"departmentId",t)},expression:"dialog.forms.departmentId"}},e._l(e.depOpts,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),l("el-form-item",{attrs:{label:"状态",prop:"status"}},[l("el-radio-group",{staticClass:"radio-status",staticStyle:{width:"100%"},model:{value:e.dialog.forms.status,callback:function(t){e.$set(e.dialog.forms,"status",t)},expression:"dialog.forms.status"}},[l("el-radio",{staticStyle:{color:"#55fb55"},attrs:{border:"",label:1}},[e._v("启用")]),l("el-radio",{staticStyle:{color:"gray"},attrs:{border:"",label:0}},[e._v("禁用")])],1)],1)],1)],1),l("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[l("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")])],1)],1)],1):e._e()},r=[],o=a(16198),i=(a(35666),a(21249),a(57327),a(41539),a(94685)),s=a(54625),n={components:{pagination:i.Z},data:function(){return{showPage:!1,hasAuth:!0,depOpts:[],roleOpts:[],filterForm:{userName:"",realName:"",phone:"",departmentId:null,status:null,pageNo:1,pageSize:10},listLoading:!0,listData:[],listTotal:0,dialog:{id:"",visible:!1,forms:{},rules:{userName:[{required:!0,trigger:"blur",message:"请输入"}],password:[{required:!0,trigger:"blur",message:"请输入"}],realName:[{required:!0,trigger:"blur",message:"请输入"}],phone:[{required:!0,trigger:"blur",message:"请输入"},{pattern:/^1[3456789]\d{9}$/,message:"手机号格式错误",trigger:"blur"}],departmentId:[{required:!0,trigger:"change",message:"请输入"}],roleIdArray:[{required:!0,trigger:"blur",message:"请输入"}],status:[{required:!0,trigger:"change",message:"请输入"}]}}}},created:function(){var e=this;(0,s.$k)().then((function(t){return e.depOpts=t.data})),(0,s.JI)().then((function(t){return e.roleOpts=t.data})),this.handleQuery()},mounted:function(){},methods:{dialogSubmit:function(){var e=this;this.$refs["dialogForm"].validate((function(t,a){if(!t)return!1;var l=null;e.dialog.forms.id?(e.dialog.forms.password=null,l=s.u5):l=s.PZ,l(e.dialog.forms).then((function(t){e.$message.success("操作成功!"),e.$refs["dialogForm"].resetFields(),e.dialog.visible=!1,e.getList()}))}))},handleQuery:function(){this.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset:function(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},handleDialog:function(e){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=8;break}return a.next=3,(0,s.YS)({id:e.id});case 3:l=a.sent,t.dialog.forms=l.data,t.$set(t.dialog.forms,"roleIdArray",l.data.roleList.filter((function(e){return"1"==e.has})).map((function(e){return e.id}))),a.next=10;break;case 8:t.dialog.forms={status:1},t.$set(t.dialog.forms,"roleIdArray",[]);case 10:t.dialog.visible=!0,t.$nextTick((function(e){return t.$refs["dialogForm"].clearValidate()}));case 12:case"end":return a.stop()}}),a)})))()},handleDel:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,s.Rp)({id:e}).then((function(e){t.getList(),t.$message.success("删除成功!")}))})).catch((function(){}))},getList:function(){var e=this;this.listLoading=!0,(0,s.m1)(this.filterForm).then((function(t){e.hasAuth=!0,e.listData=t.data.list,e.listTotal=t.data.total,e.listLoading=!1})).catch((function(t){e.hasAuth=!1})).finally((function(t){e.showPage=!0}))}}},m=n,d=a(1001),u=(0,d.Z)(m,l,r,!1,null,"6c834a34",null),c=u.exports}}]);