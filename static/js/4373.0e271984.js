"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[4373],{94373:function(e,t,l){l.r(t),l.d(t,{default:function(){return u}});var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.showPage?a("div",{staticClass:"app-container user-manage"},[e.hasAuth?e._e():a("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),e.hasAuth?a("div",{staticClass:"head"},[a("el-form",{ref:"filterForm",staticStyle:{display:"grid","grid-auto-flow":"column"},attrs:{inline:!0,size:"medium",model:e.filterForm}},[a("el-form-item",{attrs:{prop:"userName"}},[a("el-input",{attrs:{placeholder:"账号"},model:{value:e.filterForm.userName,callback:function(t){e.$set(e.filterForm,"userName","string"===typeof t?t.trim():t)},expression:"filterForm.userName"}})],1),a("el-form-item",{attrs:{prop:"realName"}},[a("el-input",{attrs:{placeholder:"姓名"},model:{value:e.filterForm.realName,callback:function(t){e.$set(e.filterForm,"realName","string"===typeof t?t.trim():t)},expression:"filterForm.realName"}})],1),a("el-form-item",{attrs:{prop:"phone"}},[a("el-input",{attrs:{placeholder:"电话"},model:{value:e.filterForm.phone,callback:function(t){e.$set(e.filterForm,"phone","string"===typeof t?t.trim():t)},expression:"filterForm.phone"}})],1),a("el-form-item",{attrs:{prop:"departmentId"}},[a("el-select",{attrs:{clearable:"",placeholder:"部门"},model:{value:e.filterForm.departmentId,callback:function(t){e.$set(e.filterForm,"departmentId",t)},expression:"filterForm.departmentId"}},e._l(e.depOpts,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"status"}},[a("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:e.filterForm.status,callback:function(t){e.$set(e.filterForm,"status",t)},expression:"filterForm.status"}},[a("el-option",{attrs:{"text-color":"#55fb55",label:"启用",value:1}}),a("el-option",{attrs:{"text-color":"gray",label:"禁用",value:0}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:function(t){return e.handleReset("filterForm")}}},[e._v("重置")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.handleDialog()}}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)],1):e._e(),e.hasAuth?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData,size:"medium"}},[a("el-table-column",{attrs:{sortable:"",prop:"userName",label:"账号"}}),a("el-table-column",{attrs:{sortable:"",prop:"realName",label:"姓名"}}),a("el-table-column",{attrs:{prop:"roleNameList",label:"角色"}}),a("el-table-column",{attrs:{prop:"departmentName",label:"部门"}}),a("el-table-column",{attrs:{prop:"phone",label:"电话"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"wechat",label:"微信"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[1==l.status?a("span",{staticStyle:{color:"#55fb55"}},[e._v("启用")]):a("span",{staticStyle:{color:"gray"}},[e._v("禁用")])]}}],null,!1,2360779935)}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"161"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(l)}}}),a("el-button",{attrs:{title:"删除",icon:"el-icon-delete",type:"primary",plain:""},on:{click:function(t){return e.handleDel(l.id)}}})]}}],null,!1,1998501215)})],1):e._e(),e.hasAuth?a("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}}):e._e(),a("el-dialog",{attrs:{visible:e.dialog.visible,top:"5vh"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[a("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"title-txt"},[e._v(e._s(e.dialog.forms.id?"编辑":"新增"))]),a("img",{attrs:{src:l(1612)}})]),a("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"账号",prop:"userName"}},[a("el-input",{attrs:{disabled:!!e.dialog.forms.id},model:{value:e.dialog.forms.userName,callback:function(t){e.$set(e.dialog.forms,"userName",t)},expression:"dialog.forms.userName"}})],1),e.dialog.forms.id?e._e():a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{model:{value:e.dialog.forms.password,callback:function(t){e.$set(e.dialog.forms,"password",t)},expression:"dialog.forms.password"}})],1),a("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr 1fr"}},[a("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[a("el-input",{model:{value:e.dialog.forms.realName,callback:function(t){e.$set(e.dialog.forms,"realName",t)},expression:"dialog.forms.realName"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{model:{value:e.dialog.forms.phone,callback:function(t){e.$set(e.dialog.forms,"phone",t)},expression:"dialog.forms.phone"}})],1)],1),a("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr 1fr"}},[a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.dialog.forms.email,callback:function(t){e.$set(e.dialog.forms,"email",t)},expression:"dialog.forms.email"}})],1),a("el-form-item",{attrs:{label:"微信",prop:"wechat"}},[a("el-input",{model:{value:e.dialog.forms.wechat,callback:function(t){e.$set(e.dialog.forms,"wechat",t)},expression:"dialog.forms.wechat"}})],1),a("el-form-item",{attrs:{label:"钉钉",prop:"dingtalk"}},[a("el-input",{model:{value:e.dialog.forms.dingtalk,callback:function(t){e.$set(e.dialog.forms,"dingtalk",t)},expression:"dialog.forms.dingtalk"}})],1)],1),a("el-form-item",{attrs:{label:"描述",prop:"remarks"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.dialog.forms.remarks,callback:function(t){e.$set(e.dialog.forms,"remarks",t)},expression:"dialog.forms.remarks"}})],1),a("el-form-item",{staticClass:"rooms-form-item",attrs:{label:"角色",prop:"roleIdArray"}},[a("el-checkbox-group",{staticClass:"rooms-el-checkbox-group",model:{value:e.dialog.forms.roleIdArray,callback:function(t){e.$set(e.dialog.forms,"roleIdArray",t)},expression:"dialog.forms.roleIdArray"}},e._l(e.roleOpts,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id,border:""}},[e._v(e._s(t.name))])})),1)],1),a("div",{staticStyle:{display:"grid","grid-template-columns":"1fr 1fr"}},[a("el-form-item",{attrs:{label:"部门",prop:"departmentId"}},[a("el-select",{model:{value:e.dialog.forms.departmentId,callback:function(t){e.$set(e.dialog.forms,"departmentId",t)},expression:"dialog.forms.departmentId"}},e._l(e.depOpts,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{staticClass:"radio-status",staticStyle:{width:"100%"},model:{value:e.dialog.forms.status,callback:function(t){e.$set(e.dialog.forms,"status",t)},expression:"dialog.forms.status"}},[a("el-radio",{staticStyle:{color:"#55fb55"},attrs:{border:"",label:1}},[e._v("启用")]),a("el-radio",{staticStyle:{color:"gray"},attrs:{border:"",label:0}},[e._v("禁用")])],1)],1)],1)],1),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")])],1)],1)],1):e._e()},r=[],i=l(87130),s=l(42070),o={components:{pagination:i.Z},data(){return{showPage:!1,hasAuth:!0,depOpts:[],roleOpts:[],filterForm:{userName:"",realName:"",phone:"",departmentId:null,status:null,pageNo:1,pageSize:10},listLoading:!0,listData:[],listTotal:0,dialog:{id:"",visible:!1,forms:{},rules:{userName:[{required:!0,trigger:"blur",message:"请输入"}],password:[{required:!0,trigger:"blur",message:"请输入"}],realName:[{required:!0,trigger:"blur",message:"请输入"}],phone:[{required:!0,trigger:"blur",message:"请输入"},{pattern:/^1[3456789]\d{9}$/,message:"手机号格式错误",trigger:"blur"}],departmentId:[{required:!0,trigger:"change",message:"请输入"}],roleIdArray:[{required:!0,trigger:"blur",message:"请输入"}],status:[{required:!0,trigger:"change",message:"请输入"}]}}}},created(){(0,s.$k)().then((e=>this.depOpts=e.data)),(0,s.JI)().then((e=>this.roleOpts=e.data)),this.handleQuery()},mounted(){},methods:{dialogSubmit(){this.$refs["dialogForm"].validate(((e,t)=>{if(!e)return!1;{let e=null;this.dialog.forms.id?(this.dialog.forms.password=null,e=s.u5):e=s.PZ,e(this.dialog.forms).then((e=>{this.$message.success("操作成功!"),this.$refs["dialogForm"].resetFields(),this.dialog.visible=!1,this.getList()}))}}))},handleQuery(){this.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},async handleDialog(e){if(e){const t=await(0,s.YS)({id:e.id});this.dialog.forms=t.data,this.$set(this.dialog.forms,"roleIdArray",t.data.roleList.filter((e=>"1"==e.has)).map((e=>e.id)))}else this.dialog.forms={status:1},this.$set(this.dialog.forms,"roleIdArray",[]);this.dialog.visible=!0,this.$nextTick((e=>this.$refs["dialogForm"].clearValidate()))},handleDel(e){this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,s.Rp)({id:e}).then((e=>{this.getList(),this.$message.success("删除成功!")}))})).catch((()=>{}))},getList(){this.listLoading=!0,(0,s.m1)(this.filterForm).then((e=>{this.hasAuth=!0,this.listData=e.data.list,this.listTotal=e.data.total,this.listLoading=!1})).catch((e=>{this.hasAuth=!1})).finally((e=>{this.showPage=!0}))}}},n=o,m=l(35471),d=(0,m.Z)(n,a,r,!1,null,"6c834a34",null),u=d.exports}}]);