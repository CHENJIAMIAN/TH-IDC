"use strict";(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[6490],{26490:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showPage?n("div",{staticClass:"app-container auth-manage"},[e.hasAuth?e._e():n("h2",{staticClass:"auth-tip"},[e._v("权限不足,请联系管理员")]),!e.dialog.visible&&e.hasAuth?n("div",{staticClass:"page1"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"empty-text":" ",height:"100%",stripe:"",border:"",data:e.listData}},[n("el-table-column",{attrs:{prop:"levelId",label:"告警等级",width:"120",align:"center"}}),n("el-table-column",{attrs:{prop:"levelName",label:"告警等级名称",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[n("div",[e._v(" "+e._s(i.levelName||"无")+" ")])]}}],null,!1,454000258)}),n("el-table-column",{attrs:{prop:"step1",label:"步骤1",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.step1,(function(t){return n("div",{key:t+Math.random()},[n("div",[e._v(" "+e._s(e.noteModeOpts.find((function(e){return e.id==t}))&&e.noteModeOpts.find((function(e){return e.id==t})).name)+" ")])])}))}}],null,!1,1517336139)}),n("el-table-column",{attrs:{prop:"step2",label:"步骤2",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.step2,(function(t){return n("div",{key:t+Math.random()},[n("div",[e._v(" "+e._s(e.noteModeOpts.find((function(e){return e.id==t}))&&e.noteModeOpts.find((function(e){return e.id==t})).name)+" ")])])}))}}],null,!1,2190177640)}),n("el-table-column",{attrs:{prop:"step3",label:"步骤3",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.step3,(function(t){return n("div",{key:t+Math.random()},[n("div",[e._v(" "+e._s(e.noteModeOpts.find((function(e){return e.id==t}))&&e.noteModeOpts.find((function(e){return e.id==t})).name)+" ")])])}))}}],null,!1,222587401)}),n("el-table-column",{attrs:{prop:"step4",label:"步骤4",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.step4,(function(t){return n("div",{key:t+Math.random()},[n("div",[e._v(" "+e._s(e.noteModeOpts.find((function(e){return e.id==t}))&&e.noteModeOpts.find((function(e){return e.id==t})).name)+" ")])])}))}}],null,!1,3500937518)}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[n("el-button",{attrs:{title:"编辑",icon:"el-icon-edit-outline",type:"primary",plain:""},on:{click:function(t){return e.handleDialog(i)}}})]}}],null,!1,784708273)})],1),n("pagination",{attrs:{hidden:!(e.listTotal>0),total:e.listTotal,page:e.filterForm.pageNo,limit:e.filterForm.pageSize},on:{"update:page":function(t){return e.$set(e.filterForm,"pageNo",t)},"update:limit":function(t){return e.$set(e.filterForm,"pageSize",t)},pagination:e.getList}})],1):e._e(),e.dialog.visible&&e.hasAuth?n("div",{staticClass:"page2"},[n("div",{staticClass:"page2-form"},[n("el-form",{ref:"dialogForm",attrs:{model:e.dialog.forms,rules:e.dialog.rules,"label-width":"100px"}},[n("div",{staticStyle:{"text-align":"center"}},[n("el-form-item",{staticStyle:{display:"inline-block"},attrs:{label:"告警等级",prop:"levelId"}},[n("el-select",{attrs:{disabled:"",filterable:""},model:{value:e.dialog.forms.levelId,callback:function(t){e.$set(e.dialog.forms,"levelId",t)},expression:"dialog.forms.levelId"}},e._l(e.alertLevelOpts,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),n("div",{staticClass:"drag-content"},[n("div",{staticClass:"left"},[n("el-form-item",{attrs:{label:"步骤1",prop:"step1"}},[e.dialog.visible?n("DragStep",{key:1,staticClass:"kanban todo",attrs:{hasArrow:"",deleteable:"",list:e.dialog.forms.step1,group:"mission",x:""}}):e._e()],1),n("el-form-item",{attrs:{label:"步骤2",prop:"step2"}},[e.dialog.visible?n("DragStep",{key:2,staticClass:"kanban",attrs:{hasArrow:"",deleteable:"",list:e.dialog.forms.step2,group:"mission"}}):e._e()],1),n("el-form-item",{attrs:{label:"步骤3",prop:"step3"}},[e.dialog.visible?n("DragStep",{key:3,staticClass:"kanban done",attrs:{hasArrow:"",deleteable:"",list:e.dialog.forms.step3,group:"mission"}}):e._e()],1),n("el-form-item",{attrs:{label:"步骤4",prop:"step4"}},[e.dialog.visible?n("DragStep",{key:4,staticClass:"kanban working",attrs:{hasArrow:"",deleteable:"",list:e.dialog.forms.step4,group:"mission"}}):e._e()],1)],1),n("div",{staticClass:"right"},[n("div",{staticClass:"el-form-item__label",staticStyle:{"text-align":"center","font-size":"1.2rem","font-weight":"bold"}},[e._v(" 可选项(拖动) ")]),e.dialog.visible?n("DragStep",{key:0,staticClass:"kanban todo",attrs:{list:e.step0,group:"mission"},on:{end:function(t){e.step0=e.deepClone(e.noteModeOpts)}}}):e._e()],1)])])],1),n("div",{staticStyle:{"text-align":"center",transform:"translate(0px, 10px)"}},[n("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("保 存")]),n("el-button",{staticStyle:{width:"200px"},on:{click:e.handleClose}},[e._v("关闭")])],1)]):e._e()]):e._e()},a=[],r=n(16198),l=(n(21249),n(69826),n(41539),n(35666),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"board-column"},[n("draggable",e._g(e._b({staticClass:"board-column-content",attrs:{list:e.list,"set-data":e.setData}},"draggable",e.$attrs,!1),e.$listeners),e._l(e.list,(function(t,i){return n("div",{key:i+Math.random(),attrs:{title:"点击移除"},on:{click:function(t){e.deleteable&&e.list.splice(i,1)}}},[n("span",{staticClass:"board-item"},[e._v(e._s(t.name))]),e.hasArrow?n("span",{staticStyle:{color:"#31c6f1"}},[e._v(e._s(i===e.list.length-1?"":"➡"))]):e._e()])})),0)],1)}),s=[],o=n(72719),d=n.n(o),u={name:"DragStep",components:{draggable:d()},props:{deleteable:{type:Boolean,default:!1},hasArrow:{type:Boolean,default:!1},options:{type:Object,default:function(){return{}}},list:{type:Array,default:function(){return[]}}},methods:{log:function(e){window.console.log(e)},setData:function(e){e.setData("Text","")}}},c=u,f=n(1001),p=(0,f.Z)(c,l,s,!1,null,"40ca4524",null),m=p.exports,g=n(98803),h=n(72217),v=n(94685),b=n(99009),_={components:{pagination:v.Z,DragStep:m},data:function(){return{showPage:!1,hasAuth:!0,deepClone:h.I8,noteModeOpts:g.ed,step0:(0,h.I8)(g.ed),depOpts:[],alertLevelOpts:[],noteContentOpts:[{id:"1",name:"时间"},{id:"2",name:"位置"},{id:"3",name:"内容"},{id:"4",name:"告警值"}],secondMenuOpts:[],thirdMenuOpts:[],filterForm:{pageNo:1,pageSize:10},listLoading:!0,listData:[],listTotal:0,dialog:{id:"",visible:!1,forms:{step1:[],step2:[],step3:[],step4:[]},rules:{levelId:[{required:!0,trigger:"blur",validator:g.C0}],step1:[{required:!0,trigger:"blur",message:"未设置"}],step2:[{required:!0,trigger:"blur",message:"未设置"}],step3:[{required:!0,trigger:"blur",message:"未设置"}],step4:[{required:!0,trigger:"blur",message:"未设置"}]}}}},watch:{},created:function(){var e=this;return(0,r.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:(0,b.D4)().then((function(t){return e.alertLevelOpts=t.data})),e.handleQuery();case 2:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{handleClose:function(){this.dialog.visible=!1,this.handleQuery()},dialogSubmit:function(){var e=this;this.$refs["dialogForm"].validate((function(t,n){if(!t)return!1;e.dialog.forms.step1=e.dialog.forms.step1.map((function(e){return e.id})),e.dialog.forms.step2=e.dialog.forms.step2.map((function(e){return e.id})),e.dialog.forms.step3=e.dialog.forms.step3.map((function(e){return e.id})),e.dialog.forms.step4=e.dialog.forms.step4.map((function(e){return e.id})),(0,b.Jc)(e.dialog.forms).then((function(t){e.$message.success("操作成功!"),e.handleDialog({levelId:e.dialog.forms.levelId})})).catch((function(t){e.handleDialog({levelId:e.dialog.forms.levelId})}))}))},handleQuery:function(){this.dialog.forms.listTotal=0,this.filterForm.pageNo=1,this.getList()},handleReset:function(e){document.activeElement.blur(),this.$refs[e].resetFields(),this.handleQuery()},handleDialog:function(e){var t=this;return(0,r.Z)(regeneratorRuntime.mark((function n(){var i,a,r,l,s,o,d,u,c,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=16;break}return n.next=3,(0,b.Mu)({levelId:e.levelId});case 3:i=n.sent,t.dialog.forms=i.data,a=t.dialog.forms,r=a.step1,l=a.step2,s=a.step3,o=a.step4,d=r.map((function(e){return g.ed.find((function(t){return t.id===e}))})),u=l.map((function(e){return g.ed.find((function(t){return t.id===e}))})),c=s.map((function(e){return g.ed.find((function(t){return t.id===e}))})),f=o.map((function(e){return g.ed.find((function(t){return t.id===e}))})),t.$set(t.dialog.forms,"step1",d),t.$set(t.dialog.forms,"step2",u),t.$set(t.dialog.forms,"step3",c),t.$set(t.dialog.forms,"step4",f),n.next=17;break;case 16:t.dialog.forms=t.$options.data().dialog.forms;case 17:t.dialog.visible=!0,t.$nextTick((function(e){return t.$refs["dialogForm"].clearValidate()}));case 19:case"end":return n.stop()}}),n)})))()},handleDel:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){alertStrategyDelete({id:e}).then((function(e){t.getList(),t.$message.success("删除成功!")}))})).catch((function(){}))},getList:function(){var e=this;this.listLoading=!0,(0,b.vc)(this.filterForm).then((function(t){e.hasAuth=!0,e.listData=t.data.list,e.listTotal=t.data.total,e.listLoading=!1})).catch((function(t){e.hasAuth=!1})).finally((function(t){e.showPage=!0}))}}},y=_,w=(0,f.Z)(y,i,a,!1,null,"2786f515",null),k=w.exports},98803:function(e,t,n){n.d(t,{C0:function(){return o},Mj:function(){return r},Uz:function(){return d},eW:function(){return s},ed:function(){return l}});var i,a=n(23796),r=(n(33161),n(9653),n(21703),[{id:1,name:"整型"},{id:2,name:"长整型"},{id:3,name:"浮点型"},{id:4,name:"布尔型"},{id:5,name:"字符串"},{id:6,name:"时间戳"}]),l=[{id:1,name:"邮箱"},{id:2,name:"短信"},{id:3,name:"语音"},{id:4,name:"微信"},{id:5,name:"钉钉"},{id:6,name:"声光"}],s=(i={id:1,name:"母联柜"},(0,a.Z)(i,"id",2),(0,a.Z)(i,"name","直流操作电源柜"),(0,a.Z)(i,"id",3),(0,a.Z)(i,"name","变压器"),(0,a.Z)(i,"id",4),(0,a.Z)(i,"name","低压进线柜"),(0,a.Z)(i,"id",5),(0,a.Z)(i,"name","配电柜"),(0,a.Z)(i,"id",6),(0,a.Z)(i,"name","柴油发电机组"),(0,a.Z)(i,"id",7),(0,a.Z)(i,"name","蓄电池"),(0,a.Z)(i,"id",8),(0,a.Z)(i,"name","UPS主机"),(0,a.Z)(i,"id",9),(0,a.Z)(i,"name","UPS变换器"),(0,a.Z)(i,"id",10),(0,a.Z)(i,"name","UPS逆变器"),(0,a.Z)(i,"id",11),(0,a.Z)(i,"name","列头柜"),(0,a.Z)(i,"id",12),(0,a.Z)(i,"name","空调"),(0,a.Z)(i,"id",13),(0,a.Z)(i,"name","温湿度"),(0,a.Z)(i,"id",14),(0,a.Z)(i,"name","氢气探测器"),(0,a.Z)(i,"id",15),(0,a.Z)(i,"name","水浸"),[{id:1,name:"北向开关"},{id:2,name:"东向开关"},{id:3,name:"西向开关"},{id:4,name:"南向开关"},{id:5,name:"温度计"}]),o=function(e,t,n){e.required||void 0!==t&&""!==t||n(),""===t||!Number.isInteger(+t)||+t<0?n(new Error("请输入整数值")):n()},d=function(e,t,n){""===t||isNaN(t)||Number(t)<0?n(new Error("请输入非负数字")):n()}}}]);