(self["webpackChunkTH_IDC"]=self["webpackChunkTH_IDC"]||[]).push([[413],{60413:function(i,e,t){"use strict";t.r(e),t.d(e,{default:function(){return g}});var a=function(){var i=this,e=i.$createElement,a=i._self._c||e;return i.showPage?a("div",{staticClass:"app-container building-manage"},[i.hasAuth?i._e():a("h2",{staticClass:"auth-tip"},[i._v("权限不足,请联系管理员")]),i.hasAuth?a("div",{staticClass:"head"},[a("el-form",{ref:"filterForm",attrs:{inline:!0,size:"medium"}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",plain:""},on:{click:i.handleReset}},[i._v("刷新缓存")]),a("el-button",{attrs:{icon:"el-icon-upload2",type:"primary",title:"上传/修改建筑物图片"},on:{click:function(e){return i.handleDialog()}}})],1)],1)],1):i._e(),i.hasAuth?a("img",{staticClass:"preview-img",staticStyle:{cursor:"pointer",height:"calc((100vh - 110px) - 11rem)"},attrs:{src:i.imgUrl,alt:"加载失败"},on:{click:function(e){i.dialogImgVisible=!0,i.dialogImgUrl=i.imgUrl}}}):i._e(),a("el-dialog",{attrs:{visible:i.dialog.visible},on:{"update:visible":function(e){return i.$set(i.dialog,"visible",e)}}},[a("div",{staticClass:"el-dialog-title-custom",attrs:{slot:"title"},slot:"title"},[a("span",{staticClass:"title-txt"},[i._v("建筑物图片")]),a("img",{attrs:{src:t(1612)}})]),a("el-form",{ref:"dialogForm",attrs:{model:i.dialog.forms,rules:i.dialog.rules,"label-width":"150px"}},[i.dialog.visible?a("el-form-item",{attrs:{label:"图片",prop:"cValue"}},[a("div",{staticClass:"preview-grid"},[a("el-upload",{ref:"upload",staticClass:"upload-container",attrs:{name:"attach",headers:i.headers,action:i.uploadUrl,data:i.uploadData,"on-success":i.uploadSuccess,"on-remove":i.fileRemove,limit:1,drag:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[i._v(" 点击 "),a("em",[i._v("上传文件")]),i._v(" 或拖拽上传 ")])]),i.dialog.forms.cValue?a("img",{staticClass:"preview-img",attrs:{src:i.dialog.forms.cValue,alt:"图片加载失败"}}):i._e()],1)]):i._e()],1),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:i.dialogSubmit}},[i._v("保 存")])],1)],1),a("el-dialog",{attrs:{"custom-class":"dialog-img",visible:i.dialogImgVisible},on:{"update:visible":function(e){i.dialogImgVisible=e}}},[a("img",{staticClass:"preview-img",attrs:{src:i.dialogImgUrl,alt:"加载失败"}})])],1):i._e()},s=[],n=(t(41539),t(38862),t(98803),t(94685)),l=t(7169),r=t(47254),o=t(81753),d={components:{pagination:n.Z},data:function(){return{showPage:!1,hasAuth:!0,uploadedFileUrl:"",headers:{token:(0,o.LP)()},uploadData:{type:1},uploadUrl:r.P,imgUrl:"",dialog:{visible:!1,forms:{},rules:{cValue:[{required:!0,message:"请上传图片"}]}},dialogImgVisible:!1,dialogImgUrl:""}},created:function(){var i=this;(0,l.uh)().then((function(e){i.hasAuth=!0,i.imgUrl=e.data.imgUrl})).catch((function(e){i.hasAuth=!1})).finally((function(e){i.showPage=!0}))},mounted:function(){},methods:{handleReset:function(){var i=this;document.activeElement.blur(),(0,l.qN)().then((function(e){i.$message.success("操作成功!")}))},uploadSuccess:function(i,e,t){0===i.res?(this.dialog.forms.cValue=i.data.filePath,this.$message.success("上传成功!")):this.$message.error(i.msg),this.$refs["dialogForm"].validateField("cValue")},fileRemove:function(i,e){this.dialog.forms.cValue="",this.$refs["dialogForm"].validateField("cValue")},dialogSubmit:function(){var i=this;this.$refs["dialogForm"].validate((function(e,t){if(!e)return!1;(0,l.cO)(i.dialog.forms).then((function(e){i.$message.success("操作成功!"),i.$refs["dialogForm"].resetFields(),i.dialog.visible=!1,(0,l.uh)().then((function(e){return i.imgUrl=e.data.imgUrl}))}))}))},handleDialog:function(i){var e=this;this.dialog.forms=i?JSON.parse(JSON.stringify(i)):{cValue:""},this.dialog.visible=!0,this.$nextTick((function(i){return e.$refs["dialogForm"].clearValidate()}))}}},u=d,c=t(1001),m=(0,c.Z)(u,a,s,!1,null,"6bb9dd5e",null),g=m.exports},55988:function(i,e,t){var a=t(70111),s=Math.floor;i.exports=Number.isInteger||function(i){return!a(i)&&isFinite(i)&&s(i)===i}},33161:function(i,e,t){var a=t(82109),s=t(55988);a({target:"Number",stat:!0},{isInteger:s})},47254:function(i,e,t){"use strict";t.d(e,{P:function(){return s}});t(25972);var a="",s=a+"/admin/uploadFile/upload"},98803:function(i,e,t){"use strict";t.d(e,{C0:function(){return o},Mj:function(){return n},Uz:function(){return d},eW:function(){return r},ed:function(){return l}});var a,s=t(23796),n=(t(33161),t(9653),t(21703),[{id:1,name:"整型"},{id:2,name:"长整型"},{id:3,name:"浮点型"},{id:4,name:"布尔型"},{id:5,name:"字符串"},{id:6,name:"时间戳"}]),l=[{id:1,name:"邮箱"},{id:2,name:"短信"},{id:3,name:"语音"},{id:4,name:"微信"},{id:5,name:"钉钉"},{id:6,name:"声光"}],r=(a={id:1,name:"母联柜"},(0,s.Z)(a,"id",2),(0,s.Z)(a,"name","直流操作电源柜"),(0,s.Z)(a,"id",3),(0,s.Z)(a,"name","变压器"),(0,s.Z)(a,"id",4),(0,s.Z)(a,"name","低压进线柜"),(0,s.Z)(a,"id",5),(0,s.Z)(a,"name","配电柜"),(0,s.Z)(a,"id",6),(0,s.Z)(a,"name","柴油发电机组"),(0,s.Z)(a,"id",7),(0,s.Z)(a,"name","蓄电池"),(0,s.Z)(a,"id",8),(0,s.Z)(a,"name","UPS主机"),(0,s.Z)(a,"id",9),(0,s.Z)(a,"name","UPS变换器"),(0,s.Z)(a,"id",10),(0,s.Z)(a,"name","UPS逆变器"),(0,s.Z)(a,"id",11),(0,s.Z)(a,"name","列头柜"),(0,s.Z)(a,"id",12),(0,s.Z)(a,"name","空调"),(0,s.Z)(a,"id",13),(0,s.Z)(a,"name","温湿度"),(0,s.Z)(a,"id",14),(0,s.Z)(a,"name","氢气探测器"),(0,s.Z)(a,"id",15),(0,s.Z)(a,"name","水浸"),[{id:1,name:"北向开关"},{id:2,name:"东向开关"},{id:3,name:"西向开关"},{id:4,name:"南向开关"},{id:5,name:"温度计"}]),o=function(i,e,t){i.required||void 0!==e&&""!==e||t(),""===e||!Number.isInteger(+e)||+e<0?t(new Error("请输入整数值")):t()},d=function(i,e,t){""===e||isNaN(e)||Number(e)<0?t(new Error("请输入非负数字")):t()}}}]);